<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>InfoFlash - URBANA VISION</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: system-ui, -apple-system, sans-serif; 
            background: linear-gradient(135deg, #134e4a 0%, #7c2d12 100%); 
            min-height: 100vh; 
            color: white; 
            padding: 20px;
        }
        .container { max-width: 800px; margin: 0 auto; }
        
        .header { 
            background: rgba(255, 255, 255, 0.1); 
            backdrop-filter: blur(10px);
            border-radius: 20px; 
            padding: 30px; 
            text-align: center; 
            margin-bottom: 30px; 
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .brand-name { 
            font-size: 28px; 
            font-weight: 800; 
            margin-bottom: 10px;
            background: linear-gradient(45deg, #10b981, #059669);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .news-section {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .news-item {
            background: rgba(16, 185, 129, 0.1);
            border-left: 4px solid #10b981;
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
            transition: all 0.3s ease;
            position: relative;
        }

        .news-item:hover {
            background: rgba(16, 185, 129, 0.15);
            transform: translateY(-2px);
        }

        .news-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 15px;
            gap: 10px;
        }

        .btn-share-whatsapp {
            background: linear-gradient(45deg, #25d366, #128c7e);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }

        .btn-share-whatsapp:hover {
            transform: translateY(-1px);
            box-shadow: 0 3px 10px rgba(37, 211, 102, 0.3);
        }

        .btn-read-more {
            background: rgba(16, 185, 129, 0.2);
            color: #10b981;
            border: 1px solid #10b981;
            padding: 8px 15px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
        }

        .btn-read-more:hover {
            background: rgba(16, 185, 129, 0.3);
            transform: translateY(-1px);
        }

        .news-date {
            color: #10b981;
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .news-title {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 10px;
            color: #fff;
        }

        .news-content {
            line-height: 1.6;
            opacity: 0.9;
            margin-bottom: 10px;
        }

        .news-source {
            font-size: 12px;
            opacity: 0.7;
            font-style: italic;
        }

        .urgent-news {
            background: rgba(239, 68, 68, 0.2);
            border-left-color: #ef4444;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.8; }
            100% { opacity: 1; }
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 15px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px;
            text-decoration: none;
            display: inline-block;
        }

        .btn-primary {
            background: linear-gradient(45deg, #10b981, #059669);
            color: white;
        }

        .btn-whatsapp {
            background: linear-gradient(45deg, #25d366, #128c7e);
            color: white;
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .promo-banner {
            background: linear-gradient(45deg, #f59e0b, #dc2626);
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            margin: 25px 0;
            box-shadow: 0 5px 20px rgba(245, 158, 11, 0.3);
        }

        .promo-banner h3 {
            font-size: 24px;
            margin-bottom: 10px;
        }

        .health-tip {
            background: rgba(34, 211, 238, 0.1);
            border: 2px solid rgba(34, 211, 238, 0.3);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
        }

        .health-tip h4 {
            color: #22d3ee;
            margin-bottom: 10px;
        }

        .footer {
            position: fixed;
            bottom: 10px;
            right: 25px;
            font-size: 10px;
            font-weight: 600;
            opacity: 0.6;
            z-index: 999;
            background: linear-gradient(45deg, #8B4513, #DAA520);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .weather-widget {
            background: rgba(59, 130, 246, 0.1);
            border: 2px solid rgba(59, 130, 246, 0.3);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            margin: 20px 0;
        }

        .social-share {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 25px 0;
            flex-wrap: wrap;
        }

        .loading {
            text-align: center;
            padding: 40px;
            font-size: 18px;
            color: #10b981;
        }

        .error {
            background: rgba(239, 68, 68, 0.2);
            border: 2px solid #ef4444;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            color: #ef4444;
            margin: 20px 0;
        }

        .back-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            background: linear-gradient(45deg, #6366f1, #4f46e5);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 12px;
            cursor: pointer;
            text-decoration: none;
            z-index: 1000;
        }

        .refresh-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(45deg, #10b981, #059669);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 12px;
            cursor: pointer;
            z-index: 1000;
        }

        .api-status {
            padding: 10px;
            border-radius: 10px;
            margin: 10px 0;
            text-align: center;
            font-size: 12px;
        }

        .api-working {
            background: rgba(16, 185, 129, 0.2);
            color: #10b981;
        }

        .api-fallback {
            background: rgba(245, 158, 11, 0.2);
            color: #f59e0b;
        }

        .api-error {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
        }

        @media (max-width: 768px) {
            .social-share {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 100%;
                max-width: 300px;
            }
        }
    </style>
</head>
<body>
    <a href="./" class="back-btn">üè† Volver al Sistema</a>
    <button onclick="forzarActualizacion()" class="refresh-btn">üîÑ Actualizar</button>

    <div class="container">
        <div class="header">
            <div style="font-size: 50px; margin-bottom: 15px;">üì∞</div>
            <h1 class="brand-name">URBANA VISION</h1>
            <h2>InfoFlash - Noticias en Tiempo Real</h2>
            <p style="margin-top: 10px;">üì± 809-713-5307 | üåê urbanavision.com</p>
            <div style="margin-top: 15px; font-size: 14px; opacity: 0.8;">
                <span id="currentDate"></span> | <span id="currentTime"></span>
            </div>
        </div>

        <div class="promo-banner">
            <h3>üéÅ ¬°PROMOCI√ìN ESPECIAL DEL MES!</h3>
            <p>30% de descuento en monturas seleccionadas + Examen visual GRATIS</p>
            <button class="btn btn-whatsapp" onclick="consultarPromocion()" style="margin-top: 15px;">
                üì± ¬°Quiero esta promoci√≥n!
            </button>
        </div>

        <div class="news-section">
            <h2>üåç Noticias Mundiales en Tiempo Real</h2>
            <div id="apiStatus" class="api-status" style="display: none;"></div>
            <div id="loadingNews" class="loading">
                <div>üì° Conectando con NewsAPI...</div>
                <div style="margin-top: 10px; font-size: 14px;">Cargando noticias internacionales</div>
            </div>
            <div id="errorNews" class="error" style="display: none;">
                ‚ùå Error de conexi√≥n. Probando fuentes alternativas...
            </div>
            <div id="newsContainer"></div>
        </div>

        <div class="health-tip">
            <h4>üí° Consejo de Salud Visual del D√≠a</h4>
            <p><strong>Protecci√≥n UV:</strong> Siempre use lentes con protecci√≥n UV al salir al sol, incluso en d√≠as nublados. Los rayos UV pueden causar cataratas y otros problemas oculares a largo plazo. ¬°Sus ojos se lo agradecer√°n!</p>
        </div>

        <div class="weather-widget">
            <h4>üå§Ô∏è Clima y Cuidado Visual</h4>
            <p><strong>Clima de Hoy:</strong> Soleado, 32¬∞C</p>
            <p>‚òÄÔ∏è <strong>Recomendaci√≥n:</strong> D√≠a perfecto para usar lentes de sol con protecci√≥n UV. El reflejo del sol en superficies puede ser intenso.</p>
        </div>

        <div class="news-section">
            <h2>üè• Noticias URBANA VISION</h2>
            
            <div class="news-item">
                <div class="news-date">üìÖ Hoy</div>
                <div class="news-title">Nuevo Equipo de Examen Digital Disponible</div>
                <div class="news-content">
                    Hemos incorporado tecnolog√≠a de √∫ltima generaci√≥n para ex√°menes m√°s precisos y r√°pidos. Nuestro nuevo autorefract√≥metro digital proporciona mediciones exactas en segundos.
                </div>
                <div class="news-actions">
                    <button class="btn-share-whatsapp" onclick="compartirNoticiaIndividual('Nuevo Equipo de Examen Digital Disponible', '#', 'Hemos incorporado tecnolog√≠a de √∫ltima generaci√≥n para ex√°menes m√°s precisos y r√°pidos.')">
                        üì± Compartir
                    </button>
                </div>
            </div>

            <div class="news-item">
                <div class="news-date">üìÖ Esta Semana</div>
                <div class="news-title">Llegada de Nueva Colecci√≥n de Monturas</div>
                <div class="news-content">
                    Recibimos m√°s de 50 modelos nuevos de monturas de las mejores marcas internacionales. Desde dise√±os cl√°sicos hasta las √∫ltimas tendencias de moda.
                </div>
                <div class="news-actions">
                    <button class="btn-share-whatsapp" onclick="compartirNoticiaIndividual('Llegada de Nueva Colecci√≥n de Monturas', '#', 'Recibimos m√°s de 50 modelos nuevos de monturas de las mejores marcas internacionales.')">
                        üì± Compartir
                    </button>
                </div>
            </div>

            <div class="news-item">
                <div class="news-date">üìÖ Mes de Julio</div>
                <div class="news-title">Campa√±a de Ex√°menes Visuales Gratuitos</div>
                <div class="news-content">
                    Durante todo el mes de julio, ofrecemos ex√°menes visuales gratuitos para estudiantes y personas mayores de 60 a√±os. Una oportunidad √∫nica de cuidar su salud visual.
                </div>
                <div class="news-actions">
                    <button class="btn-share-whatsapp" onclick="compartirNoticiaIndividual('Campa√±a de Ex√°menes Visuales Gratuitos', '#', 'Durante todo el mes de julio, ofrecemos ex√°menes visuales gratuitos para estudiantes y personas mayores de 60 a√±os.')">
                        üì± Compartir
                    </button>
                </div>
            </div>
        </div>

        <div class="news-section">
            <h2>üì± S√≠guenos y Comparte</h2>
            <p style="text-align: center; margin-bottom: 20px;">Mantente informado sobre salud visual y nuestras promociones</p>
            
            <div class="social-share">
                <button class="btn btn-whatsapp" onclick="compartirNoticias()">
                    üì± Compartir por WhatsApp
                </button>
                <button class="btn btn-primary" onclick="suscribirseNoticias()">
                    üîî Recibir Noticias
                </button>
                <button class="btn btn-secondary" onclick="agendarCita()">
                    üìÖ Agendar Cita
                </button>
            </div>
        </div>
    </div>

    <div class="footer">
        by fbrugal jrubinstein consultores
    </div>

    <script>
        console.log('üöÄ InfoFlash URBANA VISION - Versi√≥n Definitiva iniciando...');

        // Configuraci√≥n de NewsAPI PAGADA
        const NEWS_API_KEY = 'a004ca8cb8a14598a41d63adf36ffcbf';
        const NEWS_API_BASE = 'https://newsapi.org/v2';

        // Cache de noticias (separado de Nvision)
        let noticiasCache = JSON.parse(localStorage.getItem('urbana_noticias_cache') || '[]');
        let ultimaActualizacion = localStorage.getItem('urbana_ultima_actualizacion') || '0';
        
        // Actualizar fecha y hora
        function actualizarFechaHora() {
            const ahora = new Date();
            const opciones = { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            };
            
            document.getElementById('currentDate').textContent = 
                ahora.toLocaleDateString('es-ES', opciones);
            document.getElementById('currentTime').textContent = 
                ahora.toLocaleTimeString('es-ES');
        }

        async function cargarNoticias() {
            console.log('üîÑ Iniciando carga de noticias con API pagada...');
            const loadingElement = document.getElementById('loadingNews');
            const errorElement = document.getElementById('errorNews');
            const containerElement = document.getElementById('newsContainer');
            const apiStatusElement = document.getElementById('apiStatus');
            
            loadingElement.style.display = 'block';
            errorElement.style.display = 'none';
            apiStatusElement.style.display = 'none';
            containerElement.innerHTML = '';

            // Verificar cache (15 minutos para API pagada)
            const ahora = Date.now();
            const tiempoCache = 15 * 60 * 1000; // 15 minutos
            
            if (noticiasCache.length > 0 && (ahora - parseInt(ultimaActualizacion)) < tiempoCache) {
                console.log('üìÑ Usando noticias del cache');
                loadingElement.style.display = 'none';
                mostrarNoticias(noticiasCache, 'cache');
                return;
            }

            try {
                let todasNoticias = [];

                // CATEGOR√çAS ESPEC√çFICAS con tu API pagada
                const categorias = [
                    { categoria: 'entertainment', pais: 'us', limite: 5 }, // FAR√ÅNDULA
                    { categoria: 'general', pais: 'us', limite: 5 },       // NOTICIAS GENERALES
                    { categoria: 'sports', pais: 'us', limite: 3 },        // DEPORTES
                    { categoria: 'health', pais: 'us', limite: 3 },        // SALUD
                    { categoria: 'technology', pais: 'us', limite: 2 }     // TECNOLOG√çA
                ];

                console.log('üåç Cargando noticias por categor√≠as...');

                for (const cat of categorias) {
                    try {
                        const url = `${NEWS_API_BASE}/top-headlines?category=${cat.categoria}&country=${cat.pais}&pageSize=${cat.limite}&apiKey=${NEWS_API_KEY}`;
                        console.log(`üì° Cargando ${cat.categoria}...`);
                        
                        const response = await fetch(url, {
                            method: 'GET',
                            headers: {
                                'Accept': 'application/json',
                                'User-Agent': 'InfoFlash/1.0'
                            }
                        });
                        
                        if (!response.ok) {
                            console.error(`‚ùå Error ${cat.categoria}: ${response.status}`);
                            continue;
                        }
                        
                        const data = await response.json();
                        console.log(`‚úÖ ${cat.categoria}: ${data.articles?.length || 0} noticias`);
                        
                        if (data.status === 'ok' && data.articles && data.articles.length > 0) {
                            // Filtrar y agregar categor√≠a
                            const noticiasCategoria = data.articles
                                .filter(article => article.title && article.description && article.title !== '[Removed]')
                                .map(article => ({
                                    ...article,
                                    category: cat.categoria
                                }));
                            todasNoticias = [...todasNoticias, ...noticiasCategoria];
                        }
                        
                        // Delay entre requests para evitar rate limit
                        await new Promise(resolve => setTimeout(resolve, 200));
                        
                    } catch (error) {
                        console.error(`‚ùå Error cargando ${cat.categoria}:`, error);
                    }
                }

                loadingElement.style.display = 'none';

                if (todasNoticias.length > 0) {
                    console.log(`‚úÖ Total noticias cargadas: ${todasNoticias.length}`);
                    
                    // Guardar en cache
                    noticiasCache = todasNoticias;
                    ultimaActualizacion = ahora.toString();
                    localStorage.setItem('urbana_noticias_cache', JSON.stringify(noticiasCache));
                    localStorage.setItem('urbana_ultima_actualizacion', ultimaActualizacion);
                    
                    mostrarNoticias(todasNoticias, 'NewsAPI Pagada');
                    
                    apiStatusElement.innerHTML = `‚úÖ NewsAPI Activa - ${todasNoticias.length} noticias cargadas`;
                    apiStatusElement.className = 'api-status api-working';
                    apiStatusElement.style.display = 'block';
                } else {
                    console.log('‚ö†Ô∏è Sin noticias, usando respaldo');
                    throw new Error('No se obtuvieron noticias de la API');
                }

            } catch (error) {
                console.error('‚ùå Error general:', error);
                loadingElement.style.display = 'none';
                errorElement.style.display = 'block';
                
                apiStatusElement.innerHTML = '‚ùå Error de conexi√≥n - Usando noticias de respaldo';
                apiStatusElement.className = 'api-status api-error';
                apiStatusElement.style.display = 'block';
                
                setTimeout(() => {
                    mostrarNoticiasRespaldo();
                    errorElement.style.display = 'none';
                }, 3000);
            }
        }

        function mostrarNoticias(noticias, fuente) {
            const containerElement = document.getElementById('newsContainer');
            
            // Mezclar y limitar noticias
            const noticiasSeleccionadas = noticias
                .filter(article => article.title && article.description)
                .slice(0, 15);

            let newsHTML = '';
            
            noticiasSeleccionadas.forEach((article, index) => {
                const publishedDate = new Date(article.publishedAt);
                const timeAgo = getTimeAgo(publishedDate);
                const category = getCategoryEmoji(article);
                const isUrgent = index < 2;

                newsHTML += `
                    <div class="news-item ${isUrgent ? 'urgent-news' : ''}">
                        <div class="news-date">${isUrgent ? 'üî¥ URGENTE' : 'üìÖ'} ${timeAgo}</div>
                        <div class="news-title">${category} ${article.title}</div>
                        <div class="news-content">${article.description}</div>
                        <div class="news-source">üì∞ ${article.source.name}</div>
                        <div class="news-actions">
                            <button class="btn-share-whatsapp" onclick="compartirNoticiaIndividual('${encodeURIComponent(article.title)}', '${encodeURIComponent(article.url || '#')}', '${encodeURIComponent(article.description)}')">
                                üì± Compartir
                            </button>
                            <button class="btn-read-more" onclick="abrirNoticia('${encodeURIComponent(article.url || '#')}', '${encodeURIComponent(article.title)}')">
                                üëÅÔ∏è Leer m√°s
                            </button>
                        </div>
                    </div>
                `;
            });

            containerElement.innerHTML = newsHTML;
            console.log(`‚úÖ Mostrando ${noticiasSeleccionadas.length} noticias de: ${fuente}`);
        }

        function getTimeAgo(date) {
            const now = new Date();
            const diffInHours = Math.floor((now - date) / (1000 * 60 * 60));
            
            if (diffInHours < 1) return 'Hace menos de 1 hora';
            if (diffInHours < 24) return `Hace ${diffInHours} horas`;
            
            const diffInDays = Math.floor(diffInHours / 24);
            if (diffInDays === 1) return 'Hace 1 d√≠a';
            if (diffInDays < 7) return `Hace ${diffInDays} d√≠as`;
            
            return date.toLocaleDateString('es-ES');
        }

        function getCategoryEmoji(article) {
            const category = article.category || '';
            const title = article.title.toLowerCase();
            const description = (article.description || '').toLowerCase();
            const content = title + ' ' + description;

            if (category === 'entertainment' || content.includes('celebrity') || content.includes('music') || content.includes('movie') || content.includes('actor') || content.includes('singer')) {
                return 'üé¨';
            }
            if (category === 'sports' || content.includes('sport') || content.includes('game') || content.includes('football') || content.includes('soccer') || content.includes('basketball')) {
                return '‚öΩ';
            }
            if (category === 'health' || content.includes('health') || content.includes('medical') || content.includes('doctor')) {
                return 'üè•';
            }
            if (category === 'technology' || content.includes('technology') || content.includes('tech') || content.includes('ai') || content.includes('digital')) {
                return 'üíª';
            }
            if (content.includes('politics') || content.includes('election') || content.includes('government')) {
                return 'üèõÔ∏è';
            }
            if (content.includes('business') || content.includes('economy') || content.includes('finance')) {
                return 'üíº';
            }
            return 'üì∞';
        }

        function mostrarNoticiasRespaldo() {
            const noticiasRespaldo = [
                {
                    title: "Bad Bunny Anuncia Nuevo √Ålbum para Finales de 2025",
                    description: "El reguetonero puertorrique√±o confirm√≥ que est√° trabajando en su pr√≥ximo proyecto discogr√°fico, que incluir√° colaboraciones con artistas internacionales.",
                    source: { name: "Billboard" },
                    publishedAt: new Date().toISOString(),
                    category: 'entertainment'
                },
                {
                    title: "Real Madrid Gana Cl√°sico en el Santiago Bernab√©u",
                    description: "Los merengues vencieron al Barcelona en un emocionante encuentro que defini√≥ las posiciones en La Liga espa√±ola.",
                    source: { name: "Marca" },
                    publishedAt: new Date(Date.now() - 2 * 60 * 60 * 1000).toISOString(),
                    category: 'sports'
                },
                {
                    title: "Apple Lanza Nueva Generaci√≥n de iPhone con IA Avanzada",
                    description: "La tecnol√≥gica estadounidense presenta su smartphone m√°s inteligente hasta la fecha, con capacidades de inteligencia artificial revolucionarias.",
                    source: { name: "TechCrunch" },
                    publishedAt: new Date(Date.now() - 4 * 60 * 60 * 1000).toISOString(),
                    category: 'technology'
                },
                {
                    title: "Descubren Nueva Terapia para Degeneraci√≥n Macular",
                    description: "Investigadores desarrollan un tratamiento innovador que podr√≠a prevenir la p√©rdida de visi√≥n en millones de personas.",
                    source: { name: "Medical News Today" },
                    publishedAt: new Date(Date.now() - 6 * 60 * 60 * 1000).toISOString(),
                    category: 'health'
                },
                {
                    title: "Shakira Confirma Gira Mundial Despu√©s de 5 A√±os",
                    description: "La cantante colombiana anunci√≥ su regreso a los escenarios con una nueva gira que visitar√° m√°s de 30 pa√≠ses.",
                    source: { name: "Rolling Stone" },
                    publishedAt: new Date(Date.now() - 8 * 60 * 60 * 1000).toISOString(),
                    category: 'entertainment'
                },
                {
                    title: "Breakthrough en Tecnolog√≠a de Lentes de Contacto Inteligentes",
                    description: "Nueva generaci√≥n de lentes puede mostrar informaci√≥n en tiempo real y monitorear la salud ocular continuamente.",
                    source: { name: "Vision Tech" },
                    publishedAt: new Date(Date.now() - 10 * 60 * 60 * 1000).toISOString(),
                    category: 'technology'
                }
            ];

            mostrarNoticias(noticiasRespaldo, 'Noticias de Respaldo');
        }

        function compartirNoticiaIndividual(titulo, url, descripcion) {
            const decodedTitle = decodeURIComponent(titulo);
            const decodedUrl = decodeURIComponent(url);
            const decodedDesc = decodeURIComponent(descripcion);
            
            const mensaje = `üì∞ *NOTICIA DESTACADA - URBANA VISION*\n\n` +
                          `üìã *${decodedTitle}*\n\n` +
                          `üìÑ ${decodedDesc}\n\n` +
                          `${decodedUrl !== '#' ? `üîó Leer completa: ${decodedUrl}\n\n` : ''}` +
                          `üì± URBANA VISION\n` +
                          `‚òéÔ∏è 809-713-5307\n` +
                          `üåê urbanavision.com\n\n` +
                          `‚ú® Mantente informado con nuestro InfoFlash`;
            
            const whatsappUrl = `https://wa.me/?text=${encodeURIComponent(mensaje)}`;
            window.open(whatsappUrl, '_blank');
            console.log('üì± WhatsApp compartido:', decodedTitle);
        }

        function abrirNoticia(url, titulo) {
            const decodedUrl = decodeURIComponent(url);
            const decodedTitle = decodeURIComponent(titulo);
            
            if (decodedUrl === '#' || !decodedUrl) {
                alert(`üì∞ ${decodedTitle}\n\nEsta noticia est√° disponible solo como resumen.`);
                return;
            }
            
            if (confirm(`¬øDesea abrir la noticia: "${decodedTitle}"?`)) {
                window.open(decodedUrl, '_blank');
            }
        }

        function forzarActualizacion() {
            console.log('üîÑ Forzando actualizaci√≥n...');
            // Limpiar cache
            localStorage.removeItem('urbana_noticias_cache');
            localStorage.removeItem('urbana_ultima_actualizacion');
            noticiasCache = [];
            ultimaActualizacion = '0';
            
            const apiStatusElement = document.getElementById('apiStatus');
            apiStatusElement.innerHTML = 'üîÑ Actualizando noticias...';
            apiStatusElement.className = 'api-status api-fallback';
            apiStatusElement.style.display = 'block';
            
            cargarNoticias();
        }

        function consultarPromocion() {
            const mensaje = `üéÅ *CONSULTA PROMOCI√ìN ESPECIAL*\n\n` +
                          `¬°Hola! Vi en InfoFlash la promoci√≥n del mes y me interesa:\n\n` +
                          `‚ú® 30% de descuento en monturas seleccionadas\n` +
                          `üëÅÔ∏è Examen visual GRATIS\n\n` +
                          `¬øPodr√≠an darme m√°s detalles sobre:\n` +
                          `‚Ä¢ ¬øQu√© monturas est√°n incluidas?\n` +
                          `‚Ä¢ ¬øC√≥mo puedo agendar el examen?\n` +
                          `‚Ä¢ ¬øCu√°ndo vence la promoci√≥n?\n\n` +
                          `üì± URBANA VISION\n` +
                          `‚òéÔ∏è 809-713-5307\n` +
                          `üåê urbanavision.com`;
            
            const url = `https://wa.me/18097135307?text=${encodeURIComponent(mensaje)}`;
            window.open(url, '_blank');
        }

        function compartirNoticias() {
            const mensaje = `üì∞ *INFOFLASH - URBANA VISION*\n\n` +
                          `¬°Mantente informado con noticias mundiales en tiempo real!\n\n` +
                          `üåç Noticias internacionales actualizadas\n` +
                          `üé¨ Far√°ndula y entretenimiento\n` +
                          `‚öΩ Deportes internacionales\n` +
                          `üíª Tecnolog√≠a y salud\n` +
                          `üéÅ Promociones especiales\n\n` +
                          `üì± Lee m√°s noticias en nuestro InfoFlash\n` +
                          `‚òéÔ∏è 809-713-5307\n` +
                          `üåê urbanavision.com\n\n` +
                          `‚ú® Cuidamos tu salud visual`;
            
            const url = `https://wa.me/?text=${encodeURIComponent(mensaje)}`;
            window.open(url, '_blank');
        }

        function suscribirseNoticias() {
            const mensaje = `üîî *SUSCRIPCI√ìN A INFOFLASH*\n\n` +
                          `¬°Hola! Me interesa recibir el InfoFlash con noticias en tiempo real.\n\n` +
                          `Por favor, suscr√≠banme para recibir:\n` +
                          `üì∞ Noticias mundiales actualizadas\n` +
                          `üé¨ Far√°ndula internacional\n` +
                          `‚öΩ Deportes en vivo\n` +
                          `üéÅ Promociones especiales\n` +
                          `üí° Consejos de cuidado ocular\n\n` +
                          `üì± URBANA VISION\n` +
                          `‚òéÔ∏è 809-713-5307\n` +
                          `üåê urbanavision.com`;
            
            const url = `https://wa.me/18097135307?text=${encodeURIComponent(mensaje)}`;
            window.open(url, '_blank');
        }

        function agendarCita() {
            const mensaje = `üìÖ *SOLICITUD DE CITA*\n\n` +
                          `¬°Hola! He le√≠do las noticias en InfoFlash sobre la importancia de los ex√°menes anuales.\n\n` +
                          `Me gustar√≠a agendar una cita para:\n` +
                          `üëÅÔ∏è Examen visual completo\n` +
                          `üîç Revisi√≥n de salud ocular\n` +
                          `üí¨ Consulta sobre opciones de correcci√≥n\n\n` +
                          `¬øQu√© disponibilidad tienen esta semana?\n\n` +
                          `üì± URBANA VISION\n` +
                          `‚òéÔ∏è 809-713-5307\n` +
                          `üåê urbanavision.com`;
            
            const url = `https://wa.me/18097135307?text=${encodeURIComponent(mensaje)}`;
            window.open(url, '_blank');
        }

        // Inicializar
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ Iniciando InfoFlash URBANA VISION con API pagada...');
            actualizarFechaHora();
            setInterval(actualizarFechaHora, 60000);
            
            // Cargar noticias inmediatamente
            setTimeout(cargarNoticias, 1000);
            
            // Actualizar cada 10 minutos (API pagada permite m√°s requests)
            setInterval(cargarNoticias, 600000);
        });

        console.log('‚úÖ InfoFlash URBANA VISION - Sistema robusto con API pagada cargado');
    </script>
</body>
</html>
